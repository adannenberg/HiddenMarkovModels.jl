<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API reference · HiddenMarkovModels.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://gdalle.github.io/HiddenMarkovModels.jl/api/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="HiddenMarkovModels.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">HiddenMarkovModels.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../background/">Background</a></li><li><a class="tocitem" href="../tutorial/">Tutorial</a></li><li><a class="tocitem" href="../alternatives/">Alternatives</a></li><li><a class="tocitem" href="../benchmarks/">Benchmarks</a></li><li><a class="tocitem" href="../roadmap/">Roadmap</a></li><li class="is-active"><a class="tocitem" href>API reference</a><ul class="internal"><li><a class="tocitem" href="#Types"><span>Types</span></a></li><li><a class="tocitem" href="#Basics"><span>Basics</span></a></li><li><a class="tocitem" href="#Inference"><span>Inference</span></a></li><li><a class="tocitem" href="#Learning"><span>Learning</span></a></li><li><a class="tocitem" href="#Internals"><span>Internals</span></a></li><li><a class="tocitem" href="#Notations"><span>Notations</span></a></li><li><a class="tocitem" href="#Index"><span>Index</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API reference</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API reference</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/gdalle/HiddenMarkovModels.jl/blob/main/docs/src/api.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="API-reference"><a class="docs-heading-anchor" href="#API-reference">API reference</a><a id="API-reference-1"></a><a class="docs-heading-anchor-permalink" href="#API-reference" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-binding" id="HiddenMarkovModels" href="#HiddenMarkovModels"><code>HiddenMarkovModels</code></a> — <span class="docstring-category">Module</span></header><section><div><pre><code class="language-julia hljs">HiddenMarkovModels</code></pre><p>A Julia package for HMM modeling, simulation, inference and learning.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gdalle/HiddenMarkovModels.jl/blob/baeadc7d519be968f17360c0b8eb780a3141665d/src/HiddenMarkovModels.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="HiddenMarkovModels.HMMs" href="#HiddenMarkovModels.HMMs"><code>HiddenMarkovModels.HMMs</code></a> — <span class="docstring-category">Module</span></header><section><div><pre><code class="language-julia hljs">HMMs</code></pre><p>Alias for the module HiddenMarkovModels.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gdalle/HiddenMarkovModels.jl/blob/baeadc7d519be968f17360c0b8eb780a3141665d/src/HiddenMarkovModels.jl#L8-L12">source</a></section></article><h2 id="Types"><a class="docs-heading-anchor" href="#Types">Types</a><a id="Types-1"></a><a class="docs-heading-anchor-permalink" href="#Types" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="HiddenMarkovModels.AbstractModel" href="#HiddenMarkovModels.AbstractModel"><code>HiddenMarkovModels.AbstractModel</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">AbstractModel</code></pre><p>Abstract supertype for <code>AbstractMarkovChain</code> and <code>AbstractHiddenMarkovModel</code>.</p><p>Not exported.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gdalle/HiddenMarkovModels.jl/blob/baeadc7d519be968f17360c0b8eb780a3141665d/src/types/abstract_model.jl#L1-L7">source</a></section></article><h3 id="Markov-chains"><a class="docs-heading-anchor" href="#Markov-chains">Markov chains</a><a id="Markov-chains-1"></a><a class="docs-heading-anchor-permalink" href="#Markov-chains" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="HiddenMarkovModels.AbstractMarkovChain" href="#HiddenMarkovModels.AbstractMarkovChain"><code>HiddenMarkovModels.AbstractMarkovChain</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">AbstractMarkovChain &lt;: AbstractModel</code></pre><p>Abstract supertype for a Markov chain amenable to simulation, inference and learning.</p><p><strong>Required interface</strong></p><ul><li><code>initial_distribution(mc)</code></li><li><code>transition_matrix(mc)</code></li><li><code>fit!(mc, init_count, trans_count)</code> (optional)</li></ul><p><strong>Applicable methods</strong></p><ul><li><code>rand([rng,] mc, T)</code></li><li><code>logdensityof(mc, state_seq)</code></li><li><code>fit(mc, state_seq_or_seqs)</code> (if <code>fit!</code> is implemented)</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gdalle/HiddenMarkovModels.jl/blob/baeadc7d519be968f17360c0b8eb780a3141665d/src/types/abstract_mc.jl#L1-L17">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="HiddenMarkovModels.MarkovChain" href="#HiddenMarkovModels.MarkovChain"><code>HiddenMarkovModels.MarkovChain</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">MarkovChain &lt;: AbstractMarkovChain</code></pre><p>Basic implementation of a discrete-state Markov chain.</p><p><strong>Fields</strong></p><ul><li><code>init::AbstractVector</code>: initial state probabilities</li><li><code>trans::AbstractMatrix</code>: state transition matrix</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gdalle/HiddenMarkovModels.jl/blob/baeadc7d519be968f17360c0b8eb780a3141665d/src/types/mc.jl#L1-L10">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="HiddenMarkovModels.AbstractMC" href="#HiddenMarkovModels.AbstractMC"><code>HiddenMarkovModels.AbstractMC</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">AbstractMC</code></pre><p>Alias for the type <code>AbstractMarkovChain</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gdalle/HiddenMarkovModels.jl/blob/baeadc7d519be968f17360c0b8eb780a3141665d/src/types/abstract_mc.jl#L20-L24">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="HiddenMarkovModels.MC" href="#HiddenMarkovModels.MC"><code>HiddenMarkovModels.MC</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">MC</code></pre><p>Alias for the type <code>MarkovChain</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gdalle/HiddenMarkovModels.jl/blob/baeadc7d519be968f17360c0b8eb780a3141665d/src/types/mc.jl#L22-L26">source</a></section></article><h3 id="Hidden-Markov-Models"><a class="docs-heading-anchor" href="#Hidden-Markov-Models">Hidden Markov Models</a><a id="Hidden-Markov-Models-1"></a><a class="docs-heading-anchor-permalink" href="#Hidden-Markov-Models" title="Permalink"></a></h3><article class="docstring"><header><a class="docstring-binding" id="HiddenMarkovModels.AbstractHiddenMarkovModel" href="#HiddenMarkovModels.AbstractHiddenMarkovModel"><code>HiddenMarkovModels.AbstractHiddenMarkovModel</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">AbstractHiddenMarkovModel &lt;: AbstractModel</code></pre><p>Abstract supertype for an HMM amenable to simulation, inference and learning.</p><p><strong>Required interface</strong></p><ul><li><code>initial_distribution(hmm)</code></li><li><code>transition_matrix(hmm)</code></li><li><code>obs_distribution(hmm, i)</code></li><li><code>fit!(hmm, init_count, trans_count, obs_seq, state_marginals)</code> (optional)</li></ul><p><strong>Applicable methods</strong></p><ul><li><code>rand([rng,] hmm, T)</code></li><li><code>logdensityof(hmm, obs_seq)</code> / <code>logdensityof(hmm, obs_seqs, nb_seqs)</code></li><li><code>viterbi(hmm, obs_seq)</code> / <code>viterbi(hmm, obs_seqs, nb_seqs)</code></li><li><code>forward_backward(hmm, obs_seq)</code> / <code>forward_backward(hmm, obs_seqs, nb_seqs)</code></li><li><code>baum_welch(hmm, obs_seq)</code> / <code>baum_welch(hmm, obs_seqs, nb_seqs)</code> if <code>fit!</code> is implemented</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gdalle/HiddenMarkovModels.jl/blob/baeadc7d519be968f17360c0b8eb780a3141665d/src/types/abstract_hmm.jl#L1-L20">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="HiddenMarkovModels.HiddenMarkovModel" href="#HiddenMarkovModels.HiddenMarkovModel"><code>HiddenMarkovModels.HiddenMarkovModel</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">HiddenMarkovModel{D} &lt;: AbstractHiddenMarkovModel</code></pre><p>Basic implementation of an HMM.</p><p><strong>Fields</strong></p><ul><li><code>init::AbstractVector</code>: initial state probabilities</li><li><code>trans::AbstractMatrix</code>: state transition matrix</li><li><code>dists::AbstractVector{D}</code>: observation distributions</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gdalle/HiddenMarkovModels.jl/blob/baeadc7d519be968f17360c0b8eb780a3141665d/src/types/hmm.jl#L1-L11">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="HiddenMarkovModels.AbstractHMM" href="#HiddenMarkovModels.AbstractHMM"><code>HiddenMarkovModels.AbstractHMM</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">AbstractHMM</code></pre><p>Alias for the type <code>AbstractHiddenMarkovModel</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gdalle/HiddenMarkovModels.jl/blob/baeadc7d519be968f17360c0b8eb780a3141665d/src/types/abstract_hmm.jl#L23-L27">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="HiddenMarkovModels.HMM" href="#HiddenMarkovModels.HMM"><code>HiddenMarkovModels.HMM</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">HMM</code></pre><p>Alias for the type <code>HiddenMarkovModel</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gdalle/HiddenMarkovModels.jl/blob/baeadc7d519be968f17360c0b8eb780a3141665d/src/types/hmm.jl#L27-L31">source</a></section></article><h2 id="Basics"><a class="docs-heading-anchor" href="#Basics">Basics</a><a id="Basics-1"></a><a class="docs-heading-anchor-permalink" href="#Basics" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="Base.rand" href="#Base.rand"><code>Base.rand</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">rand([rng=default_rng(),] model::AbstractModel, T)</code></pre><p>Simulate <code>model</code> for <code>T</code> time steps with a specified <code>rng</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gdalle/HiddenMarkovModels.jl/blob/baeadc7d519be968f17360c0b8eb780a3141665d/src/types/interface.jl#L22-L26">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.length" href="#Base.length"><code>Base.length</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">length(model::AbstractModel)</code></pre><p>Return the number of states of <code>model</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gdalle/HiddenMarkovModels.jl/blob/baeadc7d519be968f17360c0b8eb780a3141665d/src/types/interface.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="HiddenMarkovModels.initial_distribution" href="#HiddenMarkovModels.initial_distribution"><code>HiddenMarkovModels.initial_distribution</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">initial_distribution(model::AbstractModel)</code></pre><p>Return the initial state probabilities of <code>model</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gdalle/HiddenMarkovModels.jl/blob/baeadc7d519be968f17360c0b8eb780a3141665d/src/types/interface.jl#L8-L12">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="HiddenMarkovModels.transition_matrix" href="#HiddenMarkovModels.transition_matrix"><code>HiddenMarkovModels.transition_matrix</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">transition_matrix(model::AbstractModel)</code></pre><p>Return the state transition probabilities of <code>model</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gdalle/HiddenMarkovModels.jl/blob/baeadc7d519be968f17360c0b8eb780a3141665d/src/types/interface.jl#L15-L19">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="HiddenMarkovModels.obs_distribution" href="#HiddenMarkovModels.obs_distribution"><code>HiddenMarkovModels.obs_distribution</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">obs_distribution(hmm::AbstractHMM, i)</code></pre><p>Return the observation distribution of <code>hmm</code> associated with state <code>i</code>.</p><p>The returned object <code>dist</code> must implement</p><ul><li><code>rand(rng, dist)</code></li><li><code>DensityInterface.logdensityof(dist, x)</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gdalle/HiddenMarkovModels.jl/blob/baeadc7d519be968f17360c0b8eb780a3141665d/src/types/abstract_hmm.jl#L39-L47">source</a></section></article><h2 id="Inference"><a class="docs-heading-anchor" href="#Inference">Inference</a><a id="Inference-1"></a><a class="docs-heading-anchor-permalink" href="#Inference" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="DensityInterface.logdensityof" href="#DensityInterface.logdensityof"><code>DensityInterface.logdensityof</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">logdensityof(mc, state_seq)</code></pre><p>Compute the loglikelihood of a single state sequence for a Markov chain.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gdalle/HiddenMarkovModels.jl/blob/baeadc7d519be968f17360c0b8eb780a3141665d/src/types/abstract_mc.jl#L77-L81">source</a></section><section><div><pre><code class="nohighlight hljs">logdensityof(hmm, obs_seq)</code></pre><p>Apply the forward algorithm to compute the loglikelihood of a single observation sequence for an HMM.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gdalle/HiddenMarkovModels.jl/blob/baeadc7d519be968f17360c0b8eb780a3141665d/src/inference/logdensity.jl#L22-L26">source</a></section><section><div><pre><code class="nohighlight hljs">logdensityof(hmm, obs_seqs, nb_seqs)</code></pre><p>Apply the forward algorithm to compute the total loglikelihood of multiple observation sequences for an HMM.</p><div class="admonition is-warning"><header class="admonition-header">Multithreading</header><div class="admonition-body"><p>This function is parallelized across sequences.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gdalle/HiddenMarkovModels.jl/blob/baeadc7d519be968f17360c0b8eb780a3141665d/src/inference/logdensity.jl#L40-L47">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="HiddenMarkovModels.viterbi" href="#HiddenMarkovModels.viterbi"><code>HiddenMarkovModels.viterbi</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">viterbi(hmm, obs_seq)</code></pre><p>Apply the Viterbi algorithm to compute the most likely state sequence of an HMM for a single observation sequence.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gdalle/HiddenMarkovModels.jl/blob/baeadc7d519be968f17360c0b8eb780a3141665d/src/inference/viterbi.jl#L26-L30">source</a></section><section><div><pre><code class="nohighlight hljs">viterbi(hmm, obs_seqs, nb_seqs)</code></pre><p>Apply the Viterbi algorithm to compute the most likely state sequences of an HMM for multiple observation sequences.</p><div class="admonition is-warning"><header class="admonition-header">Multithreading</header><div class="admonition-body"><p>This function is parallelized across sequences.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gdalle/HiddenMarkovModels.jl/blob/baeadc7d519be968f17360c0b8eb780a3141665d/src/inference/viterbi.jl#L48-L55">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="HiddenMarkovModels.forward_backward" href="#HiddenMarkovModels.forward_backward"><code>HiddenMarkovModels.forward_backward</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">forward_backward(hmm, obs_seq)</code></pre><p>Apply the forward-backward algorithm to estimate the posterior state marginals of an HMM for a single observation sequence, and return a <a href="#HiddenMarkovModels.ForwardBackwardStorage"><code>ForwardBackwardStorage</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gdalle/HiddenMarkovModels.jl/blob/baeadc7d519be968f17360c0b8eb780a3141665d/src/inference/forward_backward.jl#L67-L71">source</a></section><section><div><pre><code class="nohighlight hljs">forward_backward(hmm, obs_seqs, nb_seqs)</code></pre><p>Apply the forward-backward algorithm to estimate the posterior state marginals of an HMM for multiple observation sequences, and return a <a href="#HiddenMarkovModels.ForwardBackwardStorage"><code>ForwardBackwardStorage</code></a>.</p><div class="admonition is-warning"><header class="admonition-header">Multithreading</header><div class="admonition-body"><p>This function is parallelized across sequences.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gdalle/HiddenMarkovModels.jl/blob/baeadc7d519be968f17360c0b8eb780a3141665d/src/inference/forward_backward.jl#L77-L84">source</a></section></article><h2 id="Learning"><a class="docs-heading-anchor" href="#Learning">Learning</a><a id="Learning-1"></a><a class="docs-heading-anchor-permalink" href="#Learning" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="StatsAPI.fit!" href="#StatsAPI.fit!"><code>StatsAPI.fit!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">fit!(mc::MC, init_count, trans_count)</code></pre><p>Update <code>mc</code> in-place based on information generated from a state sequence.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gdalle/HiddenMarkovModels.jl/blob/baeadc7d519be968f17360c0b8eb780a3141665d/src/types/mc.jl#L33-L37">source</a></section><section><div><pre><code class="nohighlight hljs">fit!(hmm::HMM, init_count, trans_count, obs_seq, state_marginals)</code></pre><p>Update <code>hmm</code> in-place based on information generated during forward-backward.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gdalle/HiddenMarkovModels.jl/blob/baeadc7d519be968f17360c0b8eb780a3141665d/src/types/hmm.jl#L43-L47">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="StatsAPI.fit" href="#StatsAPI.fit"><code>StatsAPI.fit</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">fit(mc, state_seq_or_seqs)</code></pre><p>Fit a Markov chain of the same type as <code>mc</code> to one or several state sequence(s).</p><p>Beware that <code>mc</code> must be an actual object of type <code>MarkovChain</code>, and not the type itself as is usually done eg. in Distributions.jl.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gdalle/HiddenMarkovModels.jl/blob/baeadc7d519be968f17360c0b8eb780a3141665d/src/types/abstract_mc.jl#L52-L58">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="HiddenMarkovModels.baum_welch" href="#HiddenMarkovModels.baum_welch"><code>HiddenMarkovModels.baum_welch</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">baum_welch(
    hmm_init, obs_seq;
    max_iterations, rtol, check_loglikelihood_increasing
)</code></pre><p>Apply the Baum-Welch algorithm to estimate the parameters of an HMM and return a tuple <code>(hmm, logL_evolution)</code>.</p><p>The procedure is based on a single observation sequence and initialized with <code>hmm_init</code>.</p><div class="admonition is-danger"><header class="admonition-header">Error</header><div class="admonition-body"><p>Using a relative tolerance <code>rtol</code> to track convergence makes no sense because the loglikelihood can change signs. Always set <code>rtol=-Inf</code> for now, this will be fixed in the next breaking release.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gdalle/HiddenMarkovModels.jl/blob/baeadc7d519be968f17360c0b8eb780a3141665d/src/inference/baum_welch.jl#L54-L67">source</a></section><section><div><pre><code class="nohighlight hljs">baum_welch(
    hmm_init, obs_seqs, nb_seqs;
    max_iterations, rtol, check_loglikelihood_increasing
)</code></pre><p>Apply the Baum-Welch algorithm to estimate the parameters of an HMM and return a tuple <code>(hmm, logL_evolution)</code>.</p><p>The procedure is based on multiple observation sequences and initialized with <code>hmm_init</code>.</p><div class="admonition is-warning"><header class="admonition-header">Multithreading</header><div class="admonition-body"><p>This function is parallelized across sequences.</p></div></div><div class="admonition is-danger"><header class="admonition-header">Error</header><div class="admonition-body"><p>Using a relative tolerance <code>rtol</code> to track convergence makes no sense because the loglikelihood can change signs. Always set <code>rtol=-Inf</code> for now, this will be fixed in the next breaking release. </p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gdalle/HiddenMarkovModels.jl/blob/baeadc7d519be968f17360c0b8eb780a3141665d/src/inference/baum_welch.jl#L82-L98">source</a></section></article><h2 id="Internals"><a class="docs-heading-anchor" href="#Internals">Internals</a><a id="Internals-1"></a><a class="docs-heading-anchor-permalink" href="#Internals" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="HiddenMarkovModels.ForwardBackwardStorage" href="#HiddenMarkovModels.ForwardBackwardStorage"><code>HiddenMarkovModels.ForwardBackwardStorage</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">ForwardBackwardStorage{R}</code></pre><p>Store forward-backward quantities with element type <code>R</code>.</p><p><strong>Fields</strong></p><ul><li><code>α::Matrix{R}</code>: forward variables</li><li><code>β::Matrix{R}</code>: backward variables</li><li><code>γ::Matrix{R}</code>: one-state marginals</li><li><code>ξ::Array{R,3}</code>: two-state marginals</li><li><code>_c::Vector{R}</code>: forward variable inverse normalizations</li><li><code>_m::Vector{R}</code>: maximum of <code>logB</code></li><li><code>_Bβ::Matrix{R}</code>: stabilized product <code>Bβ</code></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gdalle/HiddenMarkovModels.jl/blob/baeadc7d519be968f17360c0b8eb780a3141665d/src/inference/forward_backward_storage.jl#L1-L15">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="HiddenMarkovModels.fit_element_from_sequence!" href="#HiddenMarkovModels.fit_element_from_sequence!"><code>HiddenMarkovModels.fit_element_from_sequence!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">fit_element_from_sequence!(dists, i, x, w)</code></pre><p>Modify the <code>i</code>-th element of <code>dists</code> by fitting it to an observation sequence <code>x</code> with associated weight sequence <code>w</code>.</p><p>The default behavior is a fallback on <code>StatsAPI.fit!(dists[i], x, w)</code>, which users are encouraged to implement if their observation distributions are mutable. If not, check out the source code below to see the hack we used for Distributions.jl, and imitate it.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gdalle/HiddenMarkovModels.jl/blob/baeadc7d519be968f17360c0b8eb780a3141665d/src/utils/fit.jl#L1-L8">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="HiddenMarkovModels.LightDiagNormal" href="#HiddenMarkovModels.LightDiagNormal"><code>HiddenMarkovModels.LightDiagNormal</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">LightDiagNormal</code></pre><p>An HMMs-compatible implementation of a multivariate normal distribution with diagonal covariance, enabling allocation-free estimation.</p><p>This is not part of the public API and is expected to change.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/gdalle/HiddenMarkovModels.jl/blob/baeadc7d519be968f17360c0b8eb780a3141665d/src/utils/lightdiagnormal.jl#L1-L7">source</a></section></article><h2 id="Notations"><a class="docs-heading-anchor" href="#Notations">Notations</a><a id="Notations-1"></a><a class="docs-heading-anchor-permalink" href="#Notations" title="Permalink"></a></h2><h3 id="Integers"><a class="docs-heading-anchor" href="#Integers">Integers</a><a id="Integers-1"></a><a class="docs-heading-anchor-permalink" href="#Integers" title="Permalink"></a></h3><ul><li><code>N</code>: number of states</li><li><code>D</code>: dimension of the observations</li><li><code>T</code>: trajectory length</li><li><code>K</code>: number of trajectories</li></ul><h3 id="Models-and-simulations"><a class="docs-heading-anchor" href="#Models-and-simulations">Models and simulations</a><a id="Models-and-simulations-1"></a><a class="docs-heading-anchor-permalink" href="#Models-and-simulations" title="Permalink"></a></h3><ul><li><code>p</code> or <code>init</code>: initial_distribution (vector of state probabilities)</li><li><code>A</code> or <code>trans</code>: transition_matrix (matrix of transition probabilities)</li><li><code>dists</code>: observation distribution (vector of <code>rand</code>-able and <code>logdensityof</code>-able objects)</li><li><code>state_seq</code>: a sequence of states (vector of integers)</li><li><code>obs_seq</code>: a sequence of observations (vector of individual observations)</li><li><code>obs_seqs</code>: several sequences of observations</li></ul><h3 id="Forward-backward"><a class="docs-heading-anchor" href="#Forward-backward">Forward backward</a><a id="Forward-backward-1"></a><a class="docs-heading-anchor-permalink" href="#Forward-backward" title="Permalink"></a></h3><ul><li><code>(log)b</code>: vector of observation (log)likelihoods by state for an individual observation</li><li><code>(log)B</code>: matrix of observation (log)likelihoods by state for a sequence of observations</li><li><code>α</code>: forward variables</li><li><code>β</code>: backward variables</li><li><code>γ</code>: one-state marginals</li><li><code>ξ</code>: two-state marginals</li><li><code>logL</code>: loglikelihood of a sequence of observations</li></ul><h2 id="Index"><a class="docs-heading-anchor" href="#Index">Index</a><a id="Index-1"></a><a class="docs-heading-anchor-permalink" href="#Index" title="Permalink"></a></h2><ul><li><a href="#HiddenMarkovModels"><code>HiddenMarkovModels</code></a></li><li><a href="#HiddenMarkovModels.HMMs"><code>HiddenMarkovModels.HMMs</code></a></li><li><a href="#HiddenMarkovModels.AbstractHMM"><code>HiddenMarkovModels.AbstractHMM</code></a></li><li><a href="#HiddenMarkovModels.AbstractHiddenMarkovModel"><code>HiddenMarkovModels.AbstractHiddenMarkovModel</code></a></li><li><a href="#HiddenMarkovModels.AbstractMC"><code>HiddenMarkovModels.AbstractMC</code></a></li><li><a href="#HiddenMarkovModels.AbstractMarkovChain"><code>HiddenMarkovModels.AbstractMarkovChain</code></a></li><li><a href="#HiddenMarkovModels.AbstractModel"><code>HiddenMarkovModels.AbstractModel</code></a></li><li><a href="#HiddenMarkovModels.ForwardBackwardStorage"><code>HiddenMarkovModels.ForwardBackwardStorage</code></a></li><li><a href="#HiddenMarkovModels.HMM"><code>HiddenMarkovModels.HMM</code></a></li><li><a href="#HiddenMarkovModels.HiddenMarkovModel"><code>HiddenMarkovModels.HiddenMarkovModel</code></a></li><li><a href="#HiddenMarkovModels.LightDiagNormal"><code>HiddenMarkovModels.LightDiagNormal</code></a></li><li><a href="#HiddenMarkovModels.MC"><code>HiddenMarkovModels.MC</code></a></li><li><a href="#HiddenMarkovModels.MarkovChain"><code>HiddenMarkovModels.MarkovChain</code></a></li><li><a href="#Base.length"><code>Base.length</code></a></li><li><a href="#Base.rand"><code>Base.rand</code></a></li><li><a href="#DensityInterface.logdensityof"><code>DensityInterface.logdensityof</code></a></li><li><a href="#HiddenMarkovModels.baum_welch"><code>HiddenMarkovModels.baum_welch</code></a></li><li><a href="#HiddenMarkovModels.fit_element_from_sequence!"><code>HiddenMarkovModels.fit_element_from_sequence!</code></a></li><li><a href="#HiddenMarkovModels.forward_backward"><code>HiddenMarkovModels.forward_backward</code></a></li><li><a href="#HiddenMarkovModels.initial_distribution"><code>HiddenMarkovModels.initial_distribution</code></a></li><li><a href="#HiddenMarkovModels.obs_distribution"><code>HiddenMarkovModels.obs_distribution</code></a></li><li><a href="#HiddenMarkovModels.transition_matrix"><code>HiddenMarkovModels.transition_matrix</code></a></li><li><a href="#HiddenMarkovModels.viterbi"><code>HiddenMarkovModels.viterbi</code></a></li><li><a href="#StatsAPI.fit"><code>StatsAPI.fit</code></a></li><li><a href="#StatsAPI.fit!"><code>StatsAPI.fit!</code></a></li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../roadmap/">« Roadmap</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Thursday 13 July 2023 09:31">Thursday 13 July 2023</span>. Using Julia version 1.9.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
